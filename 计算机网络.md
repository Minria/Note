网络背景及概念

OSI七层模型

![2021010409370574](https://gitee.com/wang-fuming/dawning/raw/master/img/202201121607376.gif)

![705728-20160424234824085-667046040](https://gitee.com/wang-fuming/dawning/raw/master/img/202201121614203.png)

TCP/IP五层（四层）模型

**物理层**: 负责光/电信号的传递方式. 比如现在以太网通用的网线(双绞 线)、早期以太网采用的的同轴电缆(现在主要用于有线电视)、光纤, 现在的wifi无线网使用电磁波等都属于物理层的概念。物理层的能力决定了最大传输速率、传输距离、抗干扰性等. 集线器(Hub)工作在物理层.

**数据链路层**: 负责设备之间的数据帧的传送和识别. 例如网卡设备的驱动、帧同步(就是说从网线上检测到什么信号算作新帧的开始)、冲突检测(如果检测到冲突就自动重发)、数据差错校验等工作. 有以太网、令牌环网, 无线LAN等标准. 交换机(Switch)工作在数据链路层.

**网络层**: 负责地址管理和路由选择. 例如在IP协议中, 通过IP地址来标识一台主机, 并通过路由表的方式规划出两台主机之间的数据传输的线路(路由). 路由器(Router)工作在网路层.

**传输层**: 负责两台主机之间的数据传输. 如传输控制协议 (TCP), 能够确保数据可靠的从源主机发送到目标主机.

**应用层**: 负责应用程序间沟通，如简单电子邮件传输（SMTP）、文件传输协议（FTP）、网络远程访问协议（Telnet）等. 我们的网络编程主要就是针对应用层.

![705728-20160424234826351-1957282396](https://gitee.com/wang-fuming/dawning/raw/master/img/202201121614204.png)

![705728-20160424234827195-1493107425](https://gitee.com/wang-fuming/dawning/raw/master/img/202201121614205.png)



# http协议

## url

```http
http://user:pass@www.example.jp:80/dir/index.htm?uid=1#ch1
```

>http->表示协议名
>
>user:pass->登录信息（现在不在使用，专门用一个登录页面）
>
>www.example.jp->这是服务器地址，也可以是域名，浏览器会自动转换为服务器地址
>
>80 ->服务器端口 http端口默认80，端口号
>
>dir/index.htm->带有文件层次的路径，路径
>
>uid=1->查询字符串，参数
>
>ch1->片段标识符，锚点

## urlencode和urldecode

像 / ? : 等这样的字符, 已经被url当做特殊意义理解了. 因此这些字符不能随意出现.
比如, 某个参数中需要带有这些特殊字符, 就必须先对特殊字符进行转义.
转义的规则如下:

将需要转码的字符转为16进制，然后从右到左，取4位(不足4位直接处理)，每2位做一位，前面加上%，编成%XY

比如，在百度搜索c++

```http
https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=baidu&wd=c%2B%2B&oq=java&rsv_pq=9eb2a0b1000a99ad&rsv_t=3cdbjRlCobvdQK1BgwHP3OIvDLDbBiFv1BBAE669a%2FbYSBCKE4M42SF5qCU&rqlang=cn&rsv_enter=1&rsv_dl=tb&rsv_sug3=4&rsv_sug1=4&rsv_sug7=101&rsv_sug2=0&rsv_btype=t&inputT=1992&rsv_sug4=1993
```

我们看到`c%2B%2B`，说明+被转义为`%2B`

urldecode就是将被转义的字符转义为回去

## http协议格式

![image-20220115143600146](https://gitee.com/wang-fuming/dawning/raw/master/img/202201151436532.png)

```http
GET http://ehall.xidian.edu.cn/login?service=http://ehall.xidian.edu.cn/new/index.html HTTP/1.1
Host: ehall.xidian.edu.cn
Connection: keep-alive
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
DNT: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36 Edg/97.0.1072.55
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: fid=16820; isfyportal=1; UM_distinctid=17e5c74a0381c2-0f9e50519bc65c-5e181552-144000-17e5c74a039c56; JSESSIONID=1k9chWC3twHyJIInU8JucyDqY22qxQafHdCYKsfT5upOHqiEiSLc!1683120314; route=7d88f93d9c668334ecfc2502d54b2b32; amp.locale=undefined; MOD_AUTH_CAS=MOD_AUTH_ST-152185-e-HPIhy9s0vow3BoAC230R-bjT0authserver6


```

1、首行: [方法] + [url] + [版本]

2、Header: 请求的属性, 冒号空格分割的键值对;每组属性之间使用\n分隔;遇到空行表示Header部分结束

3、Body: 空行后面的内容都是Body. Body允许为空字符串. 

4、如果Body存在, 则在Header中会有一个Content-Length属性来标识Body的长度;



```http
HTTP/1.1 302 Moved Temporarily
Server: openresty
Date: Sat, 15 Jan 2022 06:57:58 GMT
Content-Type: text/plain
Transfer-Encoding: chunked
Connection: keep-alive
Location: http://ehall.xidian.edu.cn/new/index.html
Content-Language: zh-CN
Set-Cookie: asessionid=1c9c794c-a19a-4c11-bf0d-93f6a192ac38; path=/
Access-Control-Allow-Credentials: true

115
<html><head><title>302 Moved Temporarily</title></head>
<body bgcolor="#FFFFFF">
<p>This document you requested has moved temporarily.</p>
<p>It's now at <a href="http://ehall.xidian.edu.cn/new/index.html">http://ehall.xidian.edu.cn/new/index.html</a>.</p>
</body></html>

0

```

1、首行: [版本号] + [状态码] + [状态码解释]

2、Header: 请求的属性, 冒号分割的键值对;每组属性之间使用\n分隔;遇到空行表示Header部分结束
3、Body: 空行后面的内容都是Body. Body允许为空字符串. 

4、如果Body存在, 则在Header中会有一个Content-Length属性来标识Body的长度; 如果服务器返回了一个html页面, 那么html页面内容就是在body中.

## http方法

![image-20220115150510765](https://gitee.com/wang-fuming/dawning/raw/master/img/202201151505019.png)

1、除了GET和POST你还知道哪些方法

2、GET和POST有说明区别

GET一般把数据放到url中

POST一般把数据放到body中

其他的区别都不是主要区别

如：GET用于从服务器获取资源，POST用于给服务器提交数据。这是设计初衷，现在两者都可以完成

GET传输数据量较小,POST上传数据量较大。这是二十年前，现在get上传数据也很大

POST比GET安全。掩耳盗铃，一个数据放在url中，一个放在body中

## http状态码

![image-20220115150536181](https://gitee.com/wang-fuming/dawning/raw/master/img/202201151505412.png)

## 常见header

1、Content-Type: 数据类型(text/html等)
2、Content-Length: Body的长度
3、Host: 客户端告知服务器, 所请求的资源是在哪个主机的哪个端口上;
4、User-Agent: 声明用户的操作系统和浏览器版本信息;
5、referer: 当前页面是从哪个页面跳转过来的;
6、location: 搭配3xx状态码使用, 告诉客户端接下来要去哪里访问;
7、Cookie: 用于在客户端存储少量信息. 通常用于实现会话(session)的功能;
