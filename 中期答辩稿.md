各位评委老师，你们好，我是汪福明，我今天答辩的题目是《基于神经网络的高光谱异常检测算法研究》

本次答辩的主要内容将要从绪论、思路和方法、研究进展以及总结四个方面展开。其中绪论中将要介绍选题背景、研究意义、综述以及一些参考文献，第二部分将介绍研究方法及算法实际运行处理步骤，第三部分将介绍当前研究阶段完成的任务。第四部分对当前阶段进行总结并规划后续任务。

-------------

高光谱遥感技术在农业、环境、地质、气象、国土资源等领域具有广泛的应用，因其可以获取物体在不同波段上的反射光谱信息，能够提供更加细致、全面的数据。然而，高光谱数据量大、维度高、存在多重共线性等问题，使得数据处理和分析的难度增加。另一方面，高光谱数据中存在异常点，如遥感像元的噪声、异常值等，这些异常点往往会干扰数据的分析和处理，因此需要进行异常检测。 传统的异常检测方法往往基于统计学假设，如基于均值和方差的方法、基于距离的方法等，这些方法在一定程度上可以检测数据中的异常点，但对于高光谱数据这种高维、复杂的数据来说，检测效果有限。因此，近年来，越来越多的研究者开始探索基于机器学习、深度学习等方法的高光谱异常检测技术，希望能够更加准确地检测高光谱数据中的异常点，提升数据的处理和分析能力。

例如，右边图像就是在军事上的应用，检测出机场中的战斗机

------------------------

研究意义主要为四点

**处理高维数据**：高光谱数据是高维的，基于神经网络的方法可以处理高维数据，从而更好地分析和处理高光谱数据。

**提高检测的准确性**：神经网络算法可以利用其强大的非线性建模能力和适应性，提高高光谱异常检测的准确性和可靠性。

**降低特征工程难度**：传统的异常检测方法需要手动提取特征，而基于神经网络的方法可以自动学习特征，减少特征工程的难度

**适应复杂场景**：高光谱数据在不同应用场景下，存在不同的异常点，基于神经网络的方法可以适应不同的异常点场景，具有较强的通用性

-------------

国内的研究现状中，基于深度学习的高光谱异常检测算法备受瞩目。深度学习算法的强大表征能力和自适应能力被认为是其成功的关键因素。在国内，专家学者们利用各种深度学习模型，如卷积神经网络（CNN）、自编码器（AE）、变分自编码器（VAE）等，进行高光谱异常检测研究。此外，高光谱异常检测在实际应用中也取得了一些成功的案例，例如，利用高光谱图像进行农作物病害和水分检测等。

在国外，深度学习算法也是高光谱异常检测的重要方法。与国内不同的是，国外研究者们更加注重不同深度学习模型的比较研究，如卷积神经网络（CNN）、循环神经网络（RNN）、长短时记忆网络（LSTM）等。除了深度学习，还有一些新的算法和模型被提出，例如，基于稀疏编码的异常检测、基于生成对抗网络（GAN）的异常检测等。

--------------------------------------------------

文献：第一个是CNN分类，第二个是卷积神经网络和低秩稀疏，第三个是转移深度学习

-----------------------

接下来是第二部分，研究思路的介绍

研究使用的卷积神经网络将会对波段数进行学习并压缩，直到最后形成全连接层并进行预测。为了保证能使用同一个全连接层，需要对数据进行预处理，保证它们在一个维度上。

所以研究的思路也就是首先对数据进行预处理，保证它们可以进入模型进行训练以及预测。其次是选择合适的神经网络进行训练。然后就是对数据预测并进行模型的评估。

-----------

在前面说到保证数据在一个维度上，比较可行的就是降维。使用的方法有PCA降维以及删除一些波段数

训练数据的处理：卷积神经网络是一种监督学习算法，训练数据包括高光谱数据以及它的地面真值（gt矩阵），在gt矩阵中将标记是异常还是背景。对训练数据的处理采用的是构造相似对以及不相似对进行处理。

神经网络的选取：有16个卷积层，每隔3层就对维度进行降维。知道最后形成全连接层，来对每个像素点进行预测

模型的评估：将测试数据放入模型中生成预测矩阵，将预测矩阵和gt矩阵计算真阳率假阳率绘制出ROC曲线。修改阈值打印出异常的灰度图。

--------------------

conv（1x3） 表示使用的是1维卷积层，并且卷积核大小为3

sride=2表示卷积的步长，默认为一，每3个对其进行降维

---

研究方案的可行性

优点：神经网络具有强大的非线性映射和特征提取能力，能够有效地处理高维度的高光谱数据。与传统的线性方法相比，基于神经网络的异常检测算法能够更准确地捕捉高光谱数据中的复杂结构和关系，从而提高检测效果和准确率。

提高鲁棒性和准确性：高光谱数据可以提供丰富的光谱信息，但同时也存在着大量的干扰和噪声。基于神经网络的异常检测算法可以有效地提高异常检测的准确性和鲁棒性，对于实际应用有着很大的帮助。

应用：基于神经网络以及深度学习的高光谱异常检测算法以及用于实践，产生了很多异常检测器，实践证明了基于神经网络的高光谱异常检测算法研究的可行性。

------------



下面介绍当前研究阶段的进展

当前阶段初步搭建出算法框架，并进行训练和检测。

1、完成数据的预处理，对训练数据删除波段，对测试数据进行降维

2、训练数据的处理，选择了构造相似对与不相似对，并送入模型训练

3、原模型需要训练50x15100，修改超参数后训练50x591，模型训练时间为：47min，模型损失率为：0.27%，0.97%，小于1%

4、对模型的评估。计算真阳以及假阳，修改阈值打印灰度图



本次展示测试数据有两个。

图1是根据测试高光谱数据A.mat进行简单还原的图像

图2是测试数据进入模型得到预测矩阵后与gt矩阵一起绘制的真阳、假阳ROC曲线。

> 真阳-假阳ROC曲线是一种用于评估分类器性能的图形展示方式。ROC曲线的横轴表示假阳率（False Positive Rate，FPR），纵轴表示真阳率（True Positive Rate，TPR），其中：
>
> 真阳率（TPR）= 真阳性数 /（真阳性数+假阴性数）
>
> 假阳率（FPR）= 假阳性数 /（假阳性数+真阴性数）
>
> 真阳率表示分类器正确识别出的阳性样本数占所有阳性样本数的比例，假阳率表示分类器错误地将阴性样本识别为阳性的比例。
>
> ROC曲线的形状和位置可以反映分类器的性能。曲线越靠近左上角，分类器的性能越好，表示真阳率高、假阳率低。曲线越靠近对角线，分类器的性能越差，表示真阳率和假阳率的比例相当。如果ROC曲线下方的面积越大，分类器的性能越好。通常将ROC曲线下方的面积称为AUC（Area Under Curve），AUC值越接近1，分类器的性能越好。

图3以及图4是修改阈值后打印的异常灰度图

全连接层也曾权重层，它们给某点进行打分，绘制ROC曲线是认为大于0.5就是异常，在打印灰度图是将会检测出所有的可能异常，超过了gt矩阵标记的异常，所以需要修改阈值打印异常进行对比。

----



图2表示面积为94.61，表明该算法可以检测出异常并且表现良好。

gt矩阵标记的异常是战斗机，在该异常图中三架战斗机明显可见，地图分界线明显可见。

------

图2表示面积为94.65

gt矩阵标记的异常是战斗机，在异常灰度图重三架战斗机明显可见。建筑分解线及其他异常明显可见

-------

问题1：探究PCA降维以及删除波段数对异常检测的结果。

现在采用的算法是对训练数据进行删除波段，对训练数据进行PCA降维。部分数据表现较好，部分数据表现极差

初步解决方案：分别采用降维和删除通道数进行对比测试

问题2：计算发现假阳率较高。根据前面的彩图可以看出真正的异常应该是飞机，但是异常检测图中出现了所有异于地面的异常。包括边界线、房子以及其他物品。

初步解决方案：推测出现的结果是因为数据集的问题，标注了多种异常。更换只有一种异常的数据集来进行训练

问题3：部分数据的异常检测真阳率较低。

初步解决方案：调整神经网络



**什么是高光谱图像？**

光谱分辨率在10$-2$λ数量级范围内的光谱图像称为**高光谱图像**(Hyperspectral Image)。高光谱图像简而言之就是**三维立体图像，**不同于黑白图片是单通道，彩色图片RGB三通道，高光谱图像的**通道数是由波段数决定的**，图像的长宽与正常图片相同，但包含了几十甚至上百个波段的信息。比如对一个物体进行高光谱成像，使用**200\*200像素并且选择300个波段**，那么最终成像结果是**200\*200\*300**的三维立体图像。

**什么是异常？**

异常，也就是离群值。

图像异常检测中的异常通常指的是图像中的不寻常或异常的区域或像素。

高光谱图像异常是某些像素的光谱特征与周围像素不同，或者与预期的光谱特征不符合的情况。这种异常可能是由于物体表面的材质、颜色、形状、光照等因素引起的。通过检测和分析高光谱图像中的异常，可以识别出物体表面的不同材质、不同颜色或不同形状的区域，从而实现高光谱图像的分类、目标检测、目标跟踪等应用。

**什么是神经网络？**

神经网络是一种模拟人脑神经系统的计算模型，它由大量的人工神经元相互连接而成，可以用于处理各种复杂的信息处理任务。

神经网络的基本组成单位是神经元。神经元接收输入信号，通过加权和并加上偏置值，经过激活函数处理后输出结果。多个神经元可以组成层次结构的网络，其中输入层接收原始数据，输出层输出最终的结果，中间的隐藏层则用于提取特征和处理信息。

神经网络的训练过程是通过反向传播算法进行的。首先随机初始化神经网络的参数，然后将训练数据输入网络，计算网络的输出结果，并计算输出结果与实际结果之间的误差。根据误差反向传播，调整网络的参数，使得误差逐渐减小，直到达到收敛状态。

神经网络在图像处理、语音识别、自然语言处理等领域有广泛的应用。

**什么是卷积神经网络？**

CNN 的主要特点是利用卷积核对输入数据进行卷积操作，从而提取出输入数据中的特征，并通过池化操作对特征进行降维。卷积神经网络通常包括多个卷积层、池化层和全连接层，其中卷积层和池化层交替出现，用于提取特征，而全连接层用于分类或回归等任务。

卷积神经网络的主要优点是能够自动提取输入数据的特征，无需手动设计特征提取器。此外，CNN 还具有参数共享和局部连接的特点，可以大大减少模型参数数量，提高模型的泛化能力和训练效率。

**构造相似对以及不相似对**

Siamese网络：它是一种用于学习相似性度量的神经网络结构，其特点是通过输入一对样本来计算它们之间的相似度或距离。

它创建了一组具有较小欧几里得距离的像素对。这是通过在每个类别的地面真实值图像中选择一部分像素，然后计算这些像素对之间的像素光谱的绝对差异来实现的。然后将得到的差异矩阵展平成一维数组，并将其上三角部分（不包括对角线）与训练数据连接起来。

构造不相似对的方法在代码中被命名为“不相似像素对”。该方法创建了来自地面真实值图像中不同类别的像素对，然后计算它们的像素光谱的绝对差异。得到的差异集合也被展平成一维数组，并与训练数据连接。

这两种方法都基于计算像素对之间的欧几里得距离，并使用此距离来确定它们是否相似或不相似。两种方法的不同之处在于，第一种方法选择相似的像素对，而第二种方法选择不相似的像素对。通过训练机器学习模型来区分这两种类型的像素对，希望该模型能够准确地检测新数据集中的异常像素。

**什么是损失率**？

机器学习中的损失率（loss rate）是指模型在训练过程中预测结果与实际结果之间的差异或误差。损失率通常用损失函数来度量，损失函数的值越小，模型的性能越好。

常见的损失函数包括均方误差（Mean Squared Error，MSE）、交叉熵（Cross Entropy）、对数损失（Log Loss）等。不同的损失函数适用于不同的问题和模型，选择合适的损失函数可以提高模型的准确性和效率。

在训练过程中，模型通过优化损失函数来调整参数，使得损失率不断降低，最终达到最优解。因此，损失率是评估机器学习模型性能的重要指标之一。
